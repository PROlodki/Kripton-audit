<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–∞–Ω–µ–ª—å –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω–Ω–æ–≥–æ –ª–∏—Ü–∞</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            display: flex;
            min-height: 100vh;
        }
        
        /* –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å */
        .sidebar {
            width: 280px;
            background-color: white;
            border-right: 1px solid #e0e0e0;
            padding: 20px 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }
        
        .user-info {
            padding: 20px;
            border-bottom: 1px solid #e0e0e0;
            margin-bottom: 20px;
        }
        
        .user-name {
            font-size: 20px;
            color: #333;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .user-role {
            font-size: 14px;
            color: #666;
        }
        
        .sidebar-title {
            padding: 0 20px 10px 20px;
            font-size: 16px;
            color: #333;
            font-weight: bold;
            border-bottom: 1px solid #e0e0e0;
            margin-bottom: 15px;
        }
        
        .department-item {
            padding: 12px 20px;
            cursor: pointer;
            color: #555;
            display: flex;
            align-items: center;
            border-left: 3px solid transparent;
        }
        
        .department-item:hover {
            background-color: #f8f8f8;
            color: #333;
        }
        
        .department-item.active {
            background-color: #f0f7ff;
            color: #0066cc;
            border-left: 3px solid #0066cc;
        }
        
        .department-icon {
            font-size: 18px;
            margin-right: 12px;
            width: 24px;
            text-align: center;
            opacity: 0; /* –°–∫—Ä—ã–≤–∞–µ–º —Ü–∏—Ñ—Ä—ã */
        }
        
        .department-name {
            flex: 1;
            font-size: 15px;
        }
        
        .report-count {
            background-color: #0066cc;
            color: white;
            font-size: 12px;
            padding: 2px 8px;
            border-radius: 10px;
        }
        
        .sidebar-footer {
            border-top: 1px solid #e0e0e0;
            padding-top: 15px;
            margin-top: auto;
        }
        
        .account-btn, .logout-btn {
            padding: 12px 20px;
            cursor: pointer;
            color: #555;
            display: flex;
            align-items: center;
            border-left: 3px solid transparent;
            background: none;
            border: none;
            width: 100%;
            text-align: left;
            font-size: inherit;
        }
        
        .account-btn:hover, .logout-btn:hover {
            background-color: #f8f8f8;
            color: #333;
        }
        
        /* –û—Å–Ω–æ–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å */
        .main-content {
            flex: 1;
            padding: 20px;
            height: 100vh;
            overflow-y: auto;
        }
        
        /* –í–µ—Ä—Ö–Ω—è—è —à–∞–ø–∫–∞ */
        .top-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .header-left h2 {
            font-size: 24px;
            color: #333;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 16px;
            color: #666;
            margin-top: 5px;
        }
        
        .header-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .request-btn {
            background-color: #0066cc;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
        }
        
        .request-btn:hover {
            background-color: #0055aa;
        }
        
        /* –ë–ª–æ–∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞—Ç–∞–º–∏ */
        .date-controls {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 18px;
        }
        
        .date-controls select {
            padding: 8px 10px;
            border-radius: 6px;
            border: 1px solid #e0e0e0;
            background: white;
            font-size: 14px;
        }
        
        .today-message {
            padding: 18px;
            background: #fff8f0;
            border: 1px solid #ffe4c4;
            border-radius: 8px;
            color: #7a4a00;
            margin-bottom: 16px;
        }
        
        /* –û—Ç—á–µ—Ç—ã */
        .reports-section {
            background-color: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 30px;
        }
        
        .reports-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .reports-title {
            font-size: 20px;
            color: #333;
            font-weight: bold;
        }
        
        .report-selector {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .report-nav-btn {
            background-color: #f8f8f8;
            border: 1px solid #e0e0e0;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            color: #333;
        }
        
        .report-nav-btn:hover {
            background-color: #f0f0f0;
        }
        
        .report-nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .report-current {
            font-weight: 500;
            color: #333;
            min-width: 160px;
            text-align: center;
        }
        
        .report-content {
            margin-bottom: 25px;
            min-height: 200px;
        }
        
        /* –¢–∞–±–ª–∏—Ü–∞ Excel-—Å—Ç–∏–ª—å (—Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è) */
        .table-container {
            overflow-x: auto;
            margin: 20px 0;
            border: 1px solid #c0c0c0;
            background-color: white;
        }
        
        .excel-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
            min-width: 600px;
        }
        
        .excel-table th {
            background-color: #f0f0f0;
            padding: 8px 12px;
            border: 1px solid #c0c0c0;
            color: #333;
            font-weight: bold;
            text-align: center;
            white-space: nowrap;
        }
        
        .excel-table td {
            padding: 8px 12px;
            border: 1px solid #c0c0c0;
            text-align: center;
            background-color: white;
            height: 36px;
        }
        
        .excel-table td.row-header {
            background-color: #f8f8f8;
            font-weight: 600;
            color: #333;
            text-align: left;
            border-right: 2px solid #c0c0c0;
            min-width: 150px;
        }
        
        .excel-table td.header-section {
            background-color: #e8e8e8;
            font-weight: bold;
            font-size: 15px;
            text-align: center;
        }
        
        .excel-table .data-cell {
            font-weight: 500;
            color: #333;
            background-color: #f9f9f9;
        }
        
        /* –î–∏–∞–≥—Ä–∞–º–º–∞ - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è */
        .chart-container {
            background-color: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 25px;
            margin-top: 30px;
        }
        
        .chart-title {
            font-size: 18px;
            color: #333;
            font-weight: bold;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .chart-wrapper {
            height: 350px;
            width: 100%;
            position: relative;
        }
        
        .chart-outer {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        
        .chart-inner {
            flex: 1;
            position: relative;
            border-left: 1px solid #ddd;
            border-bottom: 1px solid #ddd;
            margin-left: 40px;
            margin-bottom: 30px;
        }
        
        .chart-y-labels {
            position: absolute;
            left: -40px;
            top: 0;
            bottom: 0;
            width: 40px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            font-size: 12px;
            color: #666;
            text-align: right;
            padding-right: 8px;
        }
        
        .chart-grid {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
        }
        
        .chart-grid-line {
            position: absolute;
            left: 0;
            right: 0;
            border-top: 1px dashed #eee;
        }
        
        .chart-bars-container {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: calc(100% - 5px);
            display: flex;
            justify-content: space-around;
            align-items: flex-end;
            padding: 0 20px;
        }
        
        .chart-bar-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 60px;
            height: 100%;
            position: relative;
        }
        
        .chart-bars-pair {
            display: flex;
            justify-content: center;
            gap: 6px;
            width: 100%;
            height: 100%;
            position: relative;
        }
        
        .chart-bar {
            width: 20px;
            position: relative;
            display: flex;
            align-items: flex-end;
        }
        
        .chart-bar-fill {
            width: 100%;
            border-radius: 3px 3px 0 0;
            transition: height 0.3s ease;
        }
        
        .chart-bar.permanent .chart-bar-fill {
            background-color: #0066cc;
        }
        
        .chart-bar.variable .chart-bar-fill {
            background-color: #33cc33;
        }
        
        .chart-bar-value {
            position: absolute;
            top: -25px; /* –ò–∑–º–µ–Ω–µ–Ω–æ: –ø–æ–¥–ø–∏—Å–∏ –Ω–µ–º–Ω–æ–≥–æ –≤—ã—à–µ —Å—Ç–æ–ª–±–∏–∫–æ–≤ */
            left: 50%;
            transform: translateX(-50%);
            font-size: 11px;
            font-weight: 600;
            color: #333;
            white-space: nowrap;
            background-color: rgba(255, 255, 255, 0.9);
            padding: 2px 4px;
            border-radius: 2px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        
        .chart-x-labels {
            display: flex;
            justify-content: space-around;
            margin-left: 40px;
            padding-top: 5px;
            font-size: 12px;
            color: #666;
        }
        
        .chart-x-label {
            width: 60px;
            text-align: center;
        }
        
        .chart-legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            font-size: 14px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 3px;
        }
        
        /* –ü–æ–¥–ø–∏—Å—å –æ—Ç—á–µ—Ç–∞ */
        .report-signature {
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px solid #f0f0f0;
            color: #666;
            font-size: 14px;
        }
        
        .signature-line {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 5px;
        }
        
        .report-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .action-btn {
            padding: 8px 16px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .download-btn {
            background-color: #0066cc;
            color: white;
        }
        
        .download-btn:hover {
            background-color: #0055aa;
        }
        
        .export-btn {
            background-color: #f8f8f8;
            color: #333;
            border: 1px solid #e0e0e0;
        }
        
        .export-btn:hover {
            background-color: #f0f0f0;
        }
        
        .report-meta {
            padding-top: 20px;
            border-top: 1px solid #f0f0f0;
            color: #666;
            font-size: 14px;
        }
        
        .report-date {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 5px;
        }
        
        .report-author {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∑–∞–ø—Ä–æ—Å–∞ –æ—Ç—á–µ—Ç–∞ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0,0,0,0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .modal-overlay.active {
            display: flex;
        }
        
        .modal {
            background-color: white;
            border-radius: 8px;
            width: 500px;
            max-width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }
        
        .modal-header {
            padding: 20px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-header h3 {
            font-size: 20px;
            color: #333;
            font-weight: bold;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }
        
        .modal-content {
            padding: 20px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 500;
        }
        
        .form-group select,
        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .modal-footer {
            padding: 15px 20px;
            border-top: 1px solid #e0e0e0;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        
        .btn-primary {
            background-color: #0066cc;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
        }
        
        .btn-secondary {
            background-color: #f8f8f8;
            color: #333;
            border: 1px solid #e0e0e0;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
        }
        
        /* –ü—É—Å—Ç–æ–π —ç–∫—Ä–∞–Ω */
        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 60px 20px;
            text-align: center;
        }
        
        .empty-icon {
            font-size: 48px;
            color: #ccc;
            margin-bottom: 20px;
        }
        
        .empty-title {
            font-size: 20px;
            color: #666;
            margin-bottom: 10px;
            font-weight: 500;
        }
        
        .empty-text {
            color: #888;
            max-width: 400px;
            line-height: 1.5;
        }
    </style>
</head>
<body>
    <!-- –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å -->
    <div class="sidebar">
        <div class="user-info">
            <div class="user-name">–ó–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω–Ω–æ–µ –ª–∏—Ü–æ</div>
            <div class="user-role">–ü–∞–Ω–µ–ª—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</div>
        </div>
        
        <div class="sidebar-title">–î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è</div>
        
        <div class="department-item active" onclick="selectDepartment('dept1')">
            <div class="department-icon">1</div>
            <div class="department-name">–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ 1</div>
            <div class="report-count">15</div>
        </div>
        
        <div class="department-item" onclick="selectDepartment('dept2')">
            <div class="department-icon">2</div>
            <div class="department-name">–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ 2</div>
            <div class="report-count">12</div>
        </div>
        
        <div class="department-item" onclick="selectDepartment('dept3')">
            <div class="department-icon">3</div>
            <div class="department-name">–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ 3</div>
            <div class="report-count">8</div>
        </div>
        
        <div class="department-item" onclick="selectDepartment('dept4')">
            <div class="department-icon">4</div>
            <div class="department-name">–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ 4</div>
            <div class="report-count">5</div>
        </div>
        
        <div class="sidebar-footer">
            <button class="account-btn" onclick="showAccount()">
                –ê–∫–∫–∞—É–Ω—Ç
            </button>
            <button class="logout-btn" onclick="logout()">
                –í—ã–π—Ç–∏
            </button>
        </div>
    </div>
    
    <!-- –û—Å–Ω–æ–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å -->
    <div class="main-content">
        <!-- –í–µ—Ä—Ö–Ω—è—è —à–∞–ø–∫–∞ -->
        <div class="top-header">
            <div class="header-left">
                <h2 id="currentDepartment">–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ 1</h2>
                <div class="header-subtitle">–û—Ç—á–µ—Ç—ã –ø–æ —Ä–∞—Å—Ö–æ–¥—É –ª–∏—á–Ω–æ–≥–æ —Å–æ—Å—Ç–∞–≤–∞</div>
            </div>
            
            <div class="header-right">
                <button class="request-btn" onclick="showRequestModal()">
                    üìÑ –ó–∞–ø—Ä–æ—Å–∏—Ç—å –Ω–æ–≤—ã–π –æ—Ç—á–µ—Ç
                </button>
            </div>
        </div>
        
        <!-- –ö–æ–Ω—Ç—Ä–æ–ª—ã –¥–∞—Ç—ã: –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–Ω–∞—á–∞–ª–∞ —Å–µ–≥–æ–¥–Ω—è, –∑–∞—Ç–µ–º –≤—ã–ø–∞–¥. —Å–ø–∏—Å–æ–∫ –ø—Ä–æ—à–ª—ã—Ö –¥–∞—Ç -->
        <div class="date-controls">
            <label for="dateSelect">–ü–æ–∫–∞–∑–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∑–∞:</label>
            <select id="dateSelect"></select>
            <div id="todayMessage" class="today-message" style="display:none;">–°–µ–≥–æ–¥–Ω—è –¥–∞–Ω–Ω—ã—Ö –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ</div>
        </div>
        
        <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø—Ä–∏ –≤—ã–±—Ä–∞–Ω–Ω–æ–º –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–∏ -->
        <div id="departmentContent">
            <!-- –¢–µ–∫—É—â–∏–π –æ—Ç—á–µ—Ç -->
            <div class="reports-section" id="reportsSection">
                <div class="reports-header">
                    <div class="reports-title">–û—Ç—á–µ—Ç –ø–æ —Ä–∞—Å—Ö–æ–¥—É –ª–∏—á–Ω–æ–≥–æ —Å–æ—Å—Ç–∞–≤–∞</div>
                    <div class="report-selector">
                        <button class="report-nav-btn" onclick="prevReport()" id="prevBtn">‚óÄ –ü—Ä–µ–¥—ã–¥—É—â–∏–π</button>
                        <div class="report-current" id="reportCounter">–û—Ç—á–µ—Ç</div>
                        <button class="report-nav-btn" onclick="nextReport()" id="nextBtn">–°–ª–µ–¥—É—é—â–∏–π ‚ñ∂</button>
                    </div>
                </div>
                
                <div class="report-content" id="reportContent">
                    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–æ JavaScript -->
                </div>
                
                <div class="report-actions" id="reportActions" style="display:none;">
                    <button class="action-btn download-btn" onclick="downloadReport()">
                        üì• –°–∫–∞—á–∞—Ç—å –æ—Ç—á–µ—Ç (PDF)
                    </button>
                    <button class="action-btn export-btn" onclick="exportToExcel()">
                        üìä –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
                    </button>
                    <button class="action-btn export-btn" onclick="exportToWord()">
                        üìù –≠–∫—Å–ø–æ—Ä—Ç –≤ Word
                    </button>
                </div>
                
                <div class="report-meta" id="reportMeta" style="display:none;">
                    <div class="report-date">
                        <span>üìÖ</span>
                        <span id="reportDateText"></span>
                    </div>
                    <div class="report-author">
                        <span>üë§</span>
                        <span id="reportAuthorText"></span>
                    </div>
                </div>
            </div>
            
            <!-- –î–∏–∞–≥—Ä–∞–º–º–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞—Å—Ö–æ–¥–∞ -->
            <div class="chart-container">
                <div class="chart-title">–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–∞ –ª–∏—á–Ω–æ–≥–æ —Å–æ—Å—Ç–∞–≤–∞ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–µ—Å—è—Ü</div>
                <div id="chartContainer" class="chart-wrapper">
                    <!-- –î–∏–∞–≥—Ä–∞–º–º–∞ –±—É–¥–µ—Ç –æ—Ç—Ä–∏—Å–æ–≤–∞–Ω–∞ JavaScript -->
                </div>
                <div class="chart-legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #0066cc;"></div>
                        <span>–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π —Å–æ—Å—Ç–∞–≤</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #33cc33;"></div>
                        <span>–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–π —Å–æ—Å—Ç–∞–≤</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –ü—É—Å—Ç–æ–π —ç–∫—Ä–∞–Ω –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π -->
        <div id="emptyState" class="empty-state" style="display: none;">
            <div class="empty-icon">üìÅ</div>
            <div class="empty-title">–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π</div>
            <div class="empty-text">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –µ—â–µ –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏–ª –¥–æ—Å—Ç—É–ø –∫ –æ—Ç—á–µ—Ç–∞–º –Ω–∏ –æ–¥–Ω–æ–≥–æ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞.</div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∑–∞–ø—Ä–æ—Å–∞ –æ—Ç—á–µ—Ç–∞ -->
    <div class="modal-overlay" id="requestModal">
        <div class="modal">
            <div class="modal-header">
                <h3>–ó–∞–ø—Ä–æ—Å –Ω–æ–≤–æ–≥–æ –æ—Ç—á–µ—Ç–∞</h3>
                <button class="close-modal" onclick="closeModal()">√ó</button>
            </div>
            <div class="modal-content">
                <div class="form-group">
                    <label>–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ</label>
                    <select id="requestDepartment">
                        <option value="dept1">–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ 1</option>
                        <option value="dept2">–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ 2</option>
                        <option value="dept3">–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ 3</option>
                        <option value="dept4">–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ 4</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>–ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–∞</label>
                    <input type="text" id="requestTitle" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –û—Ç—á–µ—Ç –∑–∞ –¥–µ–∫–∞–±—Ä—å 2024">
                </div>
                
                .form-group textarea {
                    min-height: 100px;
                    resize: vertical;
                }
                
                .modal-footer {
                    padding: 15px 20px;
                    border-top: 1px solid #e0e0e0;
                    display: flex;
                    justify-content: flex-end;
                    gap: 10px;
                }
                
                .btn-primary {
                    background-color: #0066cc;
                    color: white;
                    border: none;
                    padding: 10px 20px;
                    border-radius: 4px;
                    cursor: pointer;
                    font-weight: 500;
                }
                
                .btn-secondary {
                    background-color: #f8f8f8;
                    color: #333;
                    border: 1px solid #e0e0e0;
                    padding: 10px 20px;
                    border-radius: 4px;
                    cursor: pointer;
                }
                
                /* –ü—É—Å—Ç–æ–π —ç–∫—Ä–∞–Ω */
                .empty-state {
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    justify-content: center;
                    padding: 60px 20px;
                    text-align: center;
                }
                
                .empty-icon {
                    font-size: 48px;
                    color: #ccc;
                    margin-bottom: 20px;
                }
                
                .empty-title {
                    font-size: 20px;
                    color: #666;
                    margin-bottom: 10px;
                    font-weight: 500;
                }
                
                .empty-text {
                    color: #888;
                    max-width: 400px;
                    line-height: 1.5;
                }
            </style>
        </head>
        <body>
            <!-- –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å -->
            <div class="sidebar">
                <div class="user-info">
                    <div class="user-name">–ó–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω–Ω–æ–µ –ª–∏—Ü–æ</div>
                    <div class="user-role">–ü–∞–Ω–µ–ª—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</div>
                </div>
                
                <div class="sidebar-title">–î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è</div>
                
                <div class="department-item active" onclick="selectDepartment('dept1')">
                    <div class="department-icon">1</div>
                    <div class="department-name">–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ 1</div>
                    <div class="report-count">15</div>
                </div>
                
                <div class="department-item" onclick="selectDepartment('dept2')">
                    <div class="department-icon">2</div>
                    <div class="department-name">–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ 2</div>
                    <div class="report-count">12</div>
                </div>
                
                <div class="department-item" onclick="selectDepartment('dept3')">
                    <div class="department-icon">3</div>
                    <div class="department-name">–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ 3</div>
                    <div class="report-count">8</div>
                </div>
                
                <div class="department-item" onclick="selectDepartment('dept4')">
                    <div class="department-icon">4</div>
                    <div class="department-name">–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ 4</div>
                    <div class="report-count">5</div>
                </div>
                
                <div class="sidebar-footer">
                    <button class="account-btn" onclick="showAccount()">
                        –ê–∫–∫–∞—É–Ω—Ç
                    </button>
                    <button class="logout-btn" onclick="logout()">
                        –í—ã–π—Ç–∏
                    </button>
                </div>
            </div>
            
            <!-- –û—Å–Ω–æ–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å -->
            <div class="main-content">
                <!-- –í–µ—Ä—Ö–Ω—è—è —à–∞–ø–∫–∞ -->
                <div class="top-header">
                    <div class="header-left">
                        <h2 id="currentDepartment">–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ 1</h2>
                        <div class="header-subtitle">–û—Ç—á–µ—Ç—ã –ø–æ —Ä–∞—Å—Ö–æ–¥—É –ª–∏—á–Ω–æ–≥–æ —Å–æ—Å—Ç–∞–≤–∞</div>
                    </div>
                    
                    <div class="header-right">
                        <button class="request-btn" onclick="showRequestModal()">
                            üìÑ –ó–∞–ø—Ä–æ—Å–∏—Ç—å –Ω–æ–≤—ã–π –æ—Ç—á–µ—Ç
                        </button>
                    </div>
                </div>
                
                <!-- –ö–æ–Ω—Ç—Ä–æ–ª—ã –¥–∞—Ç—ã: –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–Ω–∞—á–∞–ª–∞ —Å–µ–≥–æ–¥–Ω—è, –∑–∞—Ç–µ–º –≤—ã–ø–∞–¥. —Å–ø–∏—Å–æ–∫ –ø—Ä–æ—à–ª—ã—Ö –¥–∞—Ç -->
                <div class="date-controls">
                    <label for="dateSelect">–ü–æ–∫–∞–∑–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∑–∞:</label>
                    <select id="dateSelect"></select>
                    <div id="todayMessage" class="today-message" style="display:none;">–°–µ–≥–æ–¥–Ω—è –¥–∞–Ω–Ω—ã—Ö –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ</div>
                </div>
                
                <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø—Ä–∏ –≤—ã–±—Ä–∞–Ω–Ω–æ–º –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–∏ -->
                <div id="departmentContent">
                    <!-- –¢–µ–∫—É—â–∏–π –æ—Ç—á–µ—Ç -->
                    <div class="reports-section" id="reportsSection">
                        <div class="reports-header">
                            <div class="reports-title">–û—Ç—á–µ—Ç –ø–æ —Ä–∞—Å—Ö–æ–¥—É –ª–∏—á–Ω–æ–≥–æ —Å–æ—Å—Ç–∞–≤–∞</div>
                            <div class="report-selector">
                                <button class="report-nav-btn" onclick="prevReport()" id="prevBtn">‚óÄ –ü—Ä–µ–¥—ã–¥—É—â–∏–π</button>
                                <div class="report-current" id="reportCounter">–û—Ç—á–µ—Ç</div>
                                <button class="report-nav-btn" onclick="nextReport()" id="nextBtn">–°–ª–µ–¥—É—é—â–∏–π ‚ñ∂</button>
                            </div>
                        </div>
                        
                        <div class="report-content" id="reportContent">
                            <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–æ JavaScript -->
                        </div>
                        
                        <div class="report-actions" id="reportActions" style="display:none;">
                            <button class="action-btn download-btn" onclick="downloadReport()">
                                üì• –°–∫–∞—á–∞—Ç—å –æ—Ç—á–µ—Ç (PDF)
                            </button>
                            <button class="action-btn export-btn" onclick="exportToExcel()">
                                üìä –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
                            </button>
                            <button class="action-btn export-btn" onclick="exportToWord()">
                                üìù –≠–∫—Å–ø–æ—Ä—Ç –≤ Word
                            </button>
                        </div>
                        
                        <div class="report-meta" id="reportMeta" style="display:none;">
                            <div class="report-date">
                                <span>üìÖ</span>
                                <span id="reportDateText"></span>
                            </div>
                            <div class="report-author">
                                <span>üë§</span>
                                <span id="reportAuthorText"></span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- –î–∏–∞–≥—Ä–∞–º–º–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞—Å—Ö–æ–¥–∞ -->
                    <div class="chart-container">
                        <div class="chart-title">–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–∞ –ª–∏—á–Ω–æ–≥–æ —Å–æ—Å—Ç–∞–≤–∞ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–µ—Å—è—Ü</div>
                        <div id="chartContainer" class="chart-wrapper">
                            <!-- –î–∏–∞–≥—Ä–∞–º–º–∞ –±—É–¥–µ—Ç –æ—Ç—Ä–∏—Å–æ–≤–∞–Ω–∞ JavaScript -->
                        </div>
                        <div class="chart-legend">
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: #0066cc;"></div>
                                <span>–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π —Å–æ—Å—Ç–∞–≤</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: #33cc33;"></div>
                                <span>–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–π —Å–æ—Å—Ç–∞–≤</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- –ü—É—Å—Ç–æ–π —ç–∫—Ä–∞–Ω –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π -->
                <div id="emptyState" class="empty-state" style="display: none;">
                    <div class="empty-icon">üìÅ</div>
                    <div class="empty-title">–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π</div>
                    <div class="empty-text">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –µ—â–µ –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏–ª –¥–æ—Å—Ç—É–ø –∫ –æ—Ç—á–µ—Ç–∞–º –Ω–∏ –æ–¥–Ω–æ–≥–æ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞.</div>
                </div>
            </div>
            
            <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∑–∞–ø—Ä–æ—Å–∞ –æ—Ç—á–µ—Ç–∞ -->
            <div class="modal-overlay" id="requestModal">
                <div class="modal">
                    <div class="modal-header">
                        <h3>–ó–∞–ø—Ä–æ—Å –Ω–æ–≤–æ–≥–æ –æ—Ç—á–µ—Ç–∞</h3>
                        <button class="close-modal" onclick="closeModal()">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="form-group">
                            <label>–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ</label>
                            <select id="requestDepartment">
                                <option value="dept1">–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ 1</option>
                                <option value="dept2">–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ 2</option>
                                <option value="dept3">–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ 3</option>
                                <option value="dept4">–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ 4</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>–ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–∞</label>
                            <input type="text" id="requestTitle" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –û—Ç—á–µ—Ç –∑–∞ –¥–µ–∫–∞–±—Ä—å 2024">
                        </div>
                        
                        <div class="form-group">
                            <label>–û–ø–∏—Å–∞–Ω–∏–µ —Ç—Ä–µ–±—É–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö</label>
                            <textarea id="requestDescription" placeholder="–û–ø–∏—à–∏—Ç–µ, –∫–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤–∫–ª—é—á–µ–Ω—ã –≤ –æ—Ç—á–µ—Ç..."></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label>–°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–ø–æ –∂–µ–ª–∞–Ω–∏—é)</label>
                            <input type="date" id="requestDeadline">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn-secondary" onclick="closeModal()">–û—Ç–º–µ–Ω–∞</button>
                        <button class="btn-primary" onclick="submitRequest()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å</button>
                    </div>
                </div>
            </div>
            
            <script>
                // --------------------------
                // –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö (–≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏–¥—É—Ç —Å —Å–µ—Ä–≤–µ—Ä–∞)
                // --------------------------
                const reportsData = [
                    { 
                        id: 1, 
                        department: 'dept1', 
                        title: '–û—Ç—á–µ—Ç –ø–æ —Ä–∞—Å—Ö–æ–¥—É –ª–∏—á–Ω–æ–≥–æ —Å–æ—Å—Ç–∞–≤–∞ –∑–∞ 01.12.2024', 
                        dateISO: '2024-12-01', 
                        author: '–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å 1',
                        tableData: {
                            permanent: {
                                onList: 150,
                                present: 145,
                                duty: 3,
                                businessTrip: 2,
                                sick: 0,
                                hospital: 0
                            },
                            variable: {
                                onList: 200,
                                present: 195,
                                duty: 4,
                                businessTrip: 1,
                                sick: 0,
                                hospital: 0
                            }
                        }
                    },
                    { 
                        id: 2, 
                        department: 'dept1', 
                        title: '–û—Ç—á–µ—Ç –ø–æ —Ä–∞—Å—Ö–æ–¥—É –ª–∏—á–Ω–æ–≥–æ —Å–æ—Å—Ç–∞–≤–∞ –∑–∞ 28.11.2024', 
                        dateISO: '2024-11-28', 
                        author: '–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å 1',
                        tableData: {
                            permanent: {
                                onList: 148,
                                present: 142,
                                duty: 4,
                                businessTrip: 2,
                                sick: 0,
                                hospital: 0
                            },
                            variable: {
                                onList: 198,
                                present: 190,
                                duty: 6,
                                businessTrip: 2,
                                sick: 0,
                                hospital: 0
                            }
                        }
                    },
                    { 
                        id: 3, 
                        department: 'dept1', 
                        title: '–û—Ç—á–µ—Ç –ø–æ —Ä–∞—Å—Ö–æ–¥—É –ª–∏—á–Ω–æ–≥–æ —Å–æ—Å—Ç–∞–≤–∞ –∑–∞ 25.11.2024', 
                        dateISO: '2024-11-25', 
                        author: '–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å 1',
                        tableData: {
                            permanent: {
                                onList: 152,
                                present: 148,
                                duty: 2,
                                businessTrip: 2,
                                sick: 0,
                                hospital: 0
                            },
                            variable: {
                                onList: 205,
                                present: 200,
                                duty: 3,
                                businessTrip: 2,
                                sick: 0,
                                hospital: 0
                            }
                        }
                    },
                    { 
                        id: 4, 
                        department: 'dept2', 
                        title: '–û—Ç—á–µ—Ç –ø–æ —Ä–∞—Å—Ö–æ–¥—É –ª–∏—á–Ω–æ–≥–æ —Å–æ—Å—Ç–∞–≤–∞ –∑–∞ 01.12.2024', 
                        dateISO: '2024-12-01', 
                        author: '–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å 2',
                        tableData: {
                            permanent: {
                                onList: 120,
                                present: 115,
                                duty: 3,
                                businessTrip: 2,
                                sick: 0,
                                hospital: 0
                            },
                            variable: {
                                onList: 180,
                                present: 175,
                                duty: 4,
                                businessTrip: 1,
                                sick: 0,
                                hospital: 0
                            }
                        }
                    },
                    // –î–æ–±–∞–≤–∏–º –ø–∞—Ä—É —Å—Ç–∞—Ä—ã—Ö –¥–∞—Ç
                    { 
                        id: 5, 
                        department: 'dept1', 
                        title: '–û—Ç—á–µ—Ç –ø–æ —Ä–∞—Å—Ö–æ–¥—É –ª–∏—á–Ω–æ–≥–æ —Å–æ—Å—Ç–∞–≤–∞ –∑–∞ 15.11.2024', 
                        dateISO: '2024-11-15', 
                        author: '–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å 1',
                        tableData: {
                            permanent: {
                                onList: 155,
                                present: 150,
                                duty: 3,
                                businessTrip: 2,
                                sick: 0,
                                hospital: 0
                            },
                            variable: {
                                onList: 210,
                                present: 205,
                                duty: 3,
                                businessTrip: 2,
                                sick: 0,
                                hospital: 0
                            }
                        }
                    }
                ];

                // –î–∞–Ω–Ω—ã–µ –¥–ª—è –¥–∏–∞–≥—Ä–∞–º–º—ã (–¥–∏–Ω–∞–º–∏–∫–∞ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–µ—Å—è—Ü)
                const chartData = {
                    'dept1': {
                        dates: ['01.11', '05.11', '10.11', '15.11', '20.11', '25.11', '28.11', '01.12'],
                        permanent: [145, 147, 150, 155, 152, 148, 142, 145],
                        variable: [195, 200, 205, 210, 205, 200, 190, 195]
                    },
                    'dept2': {
                        dates: ['01.11', '05.11', '10.11', '15.11', '20.11', '25.11', '28.11', '01.12'],
                        permanent: [110, 112, 115, 118, 120, 118, 117, 115],
                        variable: [170, 175, 180, 182, 185, 182, 178, 175]
                    },
                    'dept3': {
                        dates: ['01.11', '05.11', '10.11', '15.11', '20.11', '25.11', '28.11', '01.12'],
                        permanent: [90, 92, 95, 98, 100, 98, 97, 95],
                        variable: [150, 152, 155, 158, 160, 158, 157, 155]
                    },
                    'dept4': {
                        dates: ['01.11', '05.11', '10.11', '15.11', '20.11', '25.11', '28.11', '01.12'],
                        permanent: [70, 72, 75, 78, 80, 78, 77, 75],
                        variable: [120, 122, 125, 128, 130, 128, 127, 125]
                    }
                };

                // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
                let currentDepartment = 'dept1';
                let selectedDateISO = null; // –≤—ã–±—Ä–∞–Ω–Ω–∞—è –¥–∞—Ç–∞ (ISO)
                let reportsForDate = [];
                let currentReportIndex = 0; // –∏–Ω–¥–µ–∫—Å –≤–Ω—É—Ç—Ä–∏ reportsForDate

                // –£—Ç–∏–ª–∏—Ç—ã –¥–∞—Ç—ã
                function isoToDisplay(iso) {
                    const d = new Date(iso + 'T00:00:00');
                    return d.toLocaleDateString('ru-RU');
                }

                function todayISO() {
                    const d = new Date();
                    const y = d.getFullYear();
                    const m = String(d.getMonth()+1).padStart(2,'0');
                    const day = String(d.getDate()).padStart(2,'0');
                    return `${y}-${m}-${day}`;
                }

                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–ø–∏—Å–∫–∞ –¥–∞—Ç –≤ —Å–µ–ª–µ–∫—Ç–µ: —Å–µ–≥–æ–¥–Ω—è + —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –¥–∞—Ç—ã –∏–∑ reportsData (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π)
                function populateDateSelect() {
                    const select = document.getElementById('dateSelect');
                    select.innerHTML = '';

                    const isoToday = todayISO();

                    // –°–æ–±–µ—Ä—ë–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –¥–∞—Ç—ã –∏–∑ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è
                    const datesSet = new Set();
                    reportsData.forEach(r => { 
                        if (r.department === currentDepartment) datesSet.add(r.dateISO); 
                    });

                    // –°–æ–∑–¥–∞–¥–∏–º –º–∞—Å—Å–∏–≤ –¥–∞—Ç: —Å–µ–≥–æ–¥–Ω—è (–ø–µ—Ä–≤—ã–π –ø—É–Ω–∫—Ç), –∑–∞—Ç–µ–º —Å–ø–∏—Å–æ–∫ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –¥–∞—Ç –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ —É–±—ã–≤–∞–Ω–∏—é
                    const dates = [isoToday];
                    const otherDates = Array.from(datesSet).sort((a,b)=> b.localeCompare(a));
                    otherDates.forEach(d => { 
                        if (d !== isoToday) dates.push(d); 
                    });

                    // –î–æ–±–∞–≤–∏–º –æ–ø—Ü–∏–∏ –≤ —Å–µ–ª–µ–∫—Ç
                    dates.forEach((iso, idx) => {
                        const opt = document.createElement('option');
                        if (iso === isoToday) opt.textContent = `–°–µ–≥–æ–¥–Ω—è ‚Äî ${isoToDisplay(iso)}`;
                        else opt.textContent = isoToDisplay(iso);
                        opt.value = iso;
                        select.appendChild(opt);
                    });

                    // –£—Å—Ç–∞–Ω–æ–≤–∏–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –¥–∞—Ç—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî —Å–µ–≥–æ–¥–Ω—è
                    select.value = isoToday;
                    selectedDateISO = isoToday;
                    select.onchange = onDateChange;
                }

                function onDateChange(e) {
                    selectedDateISO = e.target.value;
                    loadReportsForSelectedDate();
                }

                function loadReportsForSelectedDate() {
                    // –§–∏–ª—å—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—é –∏ –¥–∞—Ç–µ
                    reportsForDate = reportsData.filter(r => r.department === currentDepartment && r.dateISO === selectedDateISO);

                    // –ï—Å–ª–∏ –¥–∞—Ç–∞ ‚Äî —Å–µ–≥–æ–¥–Ω—è –∏ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –≤–æ–æ–±—â–µ, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                    const isoToday = todayISO();
                    const todayHasAny = reportsData.some(r => r.department === currentDepartment && r.dateISO === isoToday);
                    const todayMessageEl = document.getElementById('todayMessage');
                    if (selectedDateISO === isoToday && !todayHasAny) {
                        todayMessageEl.style.display = 'block';
                    } else {
                        todayMessageEl.style.display = 'none';
                    }

                    if (reportsForDate.length === 0) {
                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—É—Å—Ç–æ–π —ç–∫—Ä–∞–Ω –≤–Ω—É—Ç—Ä–∏ –æ–±–ª–∞—Å—Ç–∏ –æ—Ç—á—ë—Ç–∞
                        document.getElementById('reportContent').innerHTML = `<div class="empty-state"><div class="empty-icon">üì≠</div><div class="empty-title">–ó–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –¥–∞—Ç—É –¥–∞–Ω–Ω—ã—Ö –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div><div class="empty-text">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥—É—é –¥–∞—Ç—É –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –∑–∞–ø—Ä–æ—Å –Ω–∞ –Ω–æ–≤—ã–π –æ—Ç—á–µ—Ç.</div></div>`;
                        document.getElementById('reportActions').style.display = 'none';
                        document.getElementById('reportMeta').style.display = 'none';
                        document.getElementById('reportCounter').textContent = '';
                        document.getElementById('prevBtn').disabled = true;
                        document.getElementById('nextBtn').disabled = true;
                        
                        // –û—á–∏—â–∞–µ–º –¥–∏–∞–≥—Ä–∞–º–º—É
                        document.getElementById('chartContainer').innerHTML = '<div class="empty-text" style="text-align: center; padding: 40px;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –¥–∏–∞–≥—Ä–∞–º–º—ã</div>';
                        return;
                    }

                    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π –∏–Ω–¥–µ–∫—Å –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º –ø–µ—Ä–≤—ã–π –æ—Ç—á—ë—Ç
                    currentReportIndex = 0;
                    updateReportNavigation();
                    renderCurrentReport();
                    renderChart();
                }

                function renderCurrentReport() {
                    if (!reportsForDate || reportsForDate.length === 0) return;
                    const rep = reportsForDate[currentReportIndex];
                    const contentEl = document.getElementById('reportContent');

                    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º HTML –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã –æ—Ç—á–µ—Ç–∞
                    let html = `<h3>${rep.title}</h3>`;
                    
                    html += `
                    <div class="table-container">
                        <table class="excel-table">
                            <thead>
                                <tr>
                                    <th></th>
                                    <th class="header-section">–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π —Å–æ—Å—Ç–∞–≤</th>
                                    <th></th>
                                    <th class="header-section">–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–π —Å–æ—Å—Ç–∞–≤</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- –ü–æ —Å–ø–∏—Å–∫—É -->
                                <tr>
                                    <td class="row-header">–ü–æ —Å–ø–∏—Å–∫—É</td>
                                    <td class="data-cell">${rep.tableData.permanent.onList}</td>
                                    <td class="row-header">–ü–æ —Å–ø–∏—Å–∫—É</td>
                                    <td class="data-cell">${rep.tableData.variable.onList}</td>
                                </tr>
                                
                                <!-- –ù–∞–ª–∏—Ü–æ -->
                                <tr>
                                    <td class="row-header">–ù–∞–ª–∏—Ü–æ</td>
                                    <td class="data-cell">${rep.tableData.permanent.present}</td>
                                    <td class="row-header">–ù–∞–ª–∏—Ü–æ</td>
                                    <td class="data-cell">${rep.tableData.variable.present}</td>
                                </tr>
                                
                                <!-- –ù–∞—Ä—è–¥ -->
                                <tr>
                                    <td class="row-header">–ù–∞—Ä—è–¥</td>
                                    <td class="data-cell">${rep.tableData.permanent.duty}</td>
                                    <td class="row-header">–ù–∞—Ä—è–¥</td>
                                    <td class="data-cell">${rep.tableData.variable.duty}</td>
                                </tr>
                                
                                <!-- –ö–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∞ -->
                                <tr>
                                    <td class="row-header">–ö–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∞</td>
                                    <td class="data-cell">${rep.tableData.permanent.businessTrip}</td>
                                    <td class="row-header">–ö–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∞</td>
                                    <td class="data-cell">${rep.tableData.variable.businessTrip}</td>
                                </tr>
                                
                                <!-- –ë–æ–ª–µ–Ω -->
                                <tr>
                                    <td class="row-header">–ë–æ–ª–µ–Ω</td>
                                    <td class="data-cell">${rep.tableData.permanent.sick}</td>
                                    <td class="row-header">–ë–æ–ª–µ–Ω</td>
                                    <td class="data-cell">${rep.tableData.variable.sick}</td>
                                </tr>
                                
                                <!-- –õ–∞–∑–∞—Ä–µ—Ç -->
                                <tr>
                                    <td class="row-header">–õ–∞–∑–∞—Ä–µ—Ç</td>
                                    <td class="data-cell">${rep.tableData.permanent.hospital}</td>
                                    <td class="row-header">–õ–∞–∑–∞—Ä–µ—Ç</td>
                                    <td class="data-cell">${rep.tableData.variable.hospital}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="report-signature">
                        <div class="signature-line">
                            <span>üìÖ</span>
                            <span><strong>–î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã:</strong> ${rep.dateISO} 14:30</span>
                        </div>
                        <div class="signature-line">
                            <span>üë§</span>
                            <span><strong>–û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å:</strong> ${rep.author}</span>
                        </div>
                    </div>
                    `;

                    contentEl.innerHTML = html;

                    // –ü–æ–∫–∞–∑–∞—Ç—å –¥–µ–π—Å—Ç–≤–∏—è –∏ –º–µ—Ç–∞
                    document.getElementById('reportActions').style.display = 'flex';
                    document.getElementById('reportMeta').style.display = 'block';
                    document.getElementById('reportDateText').innerHTML = `<strong>–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è:</strong> ${isoToDisplay(rep.dateISO)} 14:30`;
                    document.getElementById('reportAuthorText').innerHTML = `<strong>–ê–≤—Ç–æ—Ä –æ—Ç—á–µ—Ç–∞:</strong> ${rep.author}`;
                }

                // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –¥–∏–∞–≥—Ä–∞–º–º—ã - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è
                function renderChart() {
                    const chartContainer = document.getElementById('chartContainer');
                    const data = chartData[currentDepartment];
                    
                    if (!data) {
                        chartContainer.innerHTML = '<div class="empty-text" style="text-align: center; padding: 40px;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –¥–∏–∞–≥—Ä–∞–º–º—ã</div>';
                        return;
                    }
                    
                    const maxValue = Math.max(...data.permanent, ...data.variable);
                    const availableHeight = 250; // –í—ã—Å–æ—Ç–∞ –æ–±–ª–∞—Å—Ç–∏ –¥–ª—è —Å—Ç–æ–ª–±—Ü–æ–≤
                    
                    let html = `
                    <div class="chart-outer">
                        <div class="chart-inner">
                            <div class="chart-y-labels">
                                <span>${maxValue}</span>
                                <span>${Math.round(maxValue * 0.75)}</span>
                                <span>${Math.round(maxValue * 0.5)}</span>
                                <span>${Math.round(maxValue * 0.25)}</span>
                                <span>0</span>
                            </div>
                            
                            <div class="chart-grid">
                                <div class="chart-grid-line" style="top: 0%"></div>
                                <div class="chart-grid-line" style="top: 25%"></div>
                                <div class="chart-grid-line" style="top: 50%"></div>
                                <div class="chart-grid-line" style="top: 75%"></div>
                                <div class="chart-grid-line" style="top: 100%"></div>
                            </div>
                            
                            <div class="chart-bars-container">
                    `;
                    
                    // –°–æ–∑–¥–∞–µ–º –ø–∞—Ä—ã —Å—Ç–æ–ª–±—Ü–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–π –¥–∞—Ç—ã
                    data.dates.forEach((date, index) => {
                        const permanentValue = data.permanent[index];
                        const variableValue = data.variable[index];
                        
                        const permanentHeight = (permanentValue / maxValue) * availableHeight;
                        const variableHeight = (variableValue / maxValue) * availableHeight;
                        
                        html += `
                        <div class="chart-bar-group">
                            <div class="chart-bars-pair">
                                <div class="chart-bar permanent">
                                    <div class="chart-bar-fill" style="height: ${permanentHeight}px;"></div>
                                    <div class="chart-bar-value">${permanentValue}</div>
                                </div>
                                <div class="chart-bar variable">
                                    <div class="chart-bar-fill" style="height: ${variableHeight}px;"></div>
                                    <div class="chart-bar-value">${variableValue}</div>
                                </div>
                            </div>
                        </div>
                        `;
                    });
                    
                    html += `
                            </div>
                        </div>
                        
                        <div class="chart-x-labels">
                    `;
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–ø–∏—Å–∏ –ø–æ –æ—Å–∏ X
                    data.dates.forEach(date => {
                        html += `<div class="chart-x-label">${date}</div>`;
                    });
                    
                    html += `</div></div>`;
                    
                    chartContainer.innerHTML = html;
                }

                // –ù–∞–≤–∏–≥–∞—Ü–∏—è
                function prevReport() {
                    if (currentReportIndex > 0) {
                        currentReportIndex--;
                        updateReportNavigation();
                        renderCurrentReport();
                    }
                }

                function nextReport() {
                    if (currentReportIndex < reportsForDate.length - 1) {
                        currentReportIndex++;
                        updateReportNavigation();
                        renderCurrentReport();
                    }
                }

                function updateReportNavigation() {
                    document.getElementById('reportCounter').textContent = `–û—Ç—á–µ—Ç #${currentReportIndex + 1} –∏–∑ ${reportsForDate.length}`;
                    document.getElementById('prevBtn').disabled = currentReportIndex <= 0;
                    document.getElementById('nextBtn').disabled = currentReportIndex >= reportsForDate.length - 1;
                }

                // –ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ
                function selectDepartment(dept) {
                    document.querySelectorAll('.department-item').forEach(item => item.classList.remove('active'));
                    event.target.closest('.department-item').classList.add('active');
                    currentDepartment = dept;
                    const deptNames = { 
                        'dept1': '–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ 1', 
                        'dept2': '–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ 2', 
                        'dept3': '–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ 3', 
                        'dept4': '–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ 4' 
                    };
                    document.getElementById('currentDepartment').textContent = deptNames[dept];
                    populateDateSelect();
                    loadReportsForSelectedDate();
                    renderChart();
                }

                // –î–µ–π—Å—Ç–≤–∏—è —Å –æ—Ç—á—ë—Ç–æ–º (–∑–∞–≥–ª—É—à–∫–∏)
                function downloadReport() { 
                    alert(`–û—Ç—á–µ—Ç "${reportsForDate[currentReportIndex].title}" —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ PDF`); 
                }
                
                function exportToExcel() { 
                    alert(`–û—Ç—á–µ—Ç "${reportsForDate[currentReportIndex].title}" —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤ Excel`); 
                }
                
                function exportToWord() { 
                    alert(`–û—Ç—á–µ—Ç "${reportsForDate[currentReportIndex].title}" —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤ Word`); 
                }

                // –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏ –ø—Ä–æ—á–µ–µ
                function showRequestModal() { 
                    document.getElementById('requestModal').classList.add('active'); 
                }
                
                function closeModal() { 
                    document.getElementById('requestModal').classList.remove('active'); 
                }
                
                function submitRequest() {
                    const department = document.getElementById('requestDepartment').value;
                    const title = document.getElementById('requestTitle').value;
                    const description = document.getElementById('requestDescription').value;
                    const deadline = document.getElementById('requestDeadline').value;
                    
                    if (!title.trim()) { 
                        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–∞'); 
                        return; 
                    }
                    
                    if (!description.trim()) { 
                        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–ø–∏—à–∏—Ç–µ —Ç—Ä–µ–±—É–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ'); 
                        return; 
                    }
                    
                    alert('–ó–∞–ø—Ä–æ—Å –Ω–∞ –Ω–æ–≤—ã–π –æ—Ç—á–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É');
                    closeModal();
                    document.getElementById('requestTitle').value = '';
                    document.getElementById('requestDescription').value = '';
                    document.getElementById('requestDeadline').value = '';
                }

                function showAccount() { 
                    alert('–û—Ç–∫—Ä—ã—Ç–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∞–∫–∫–∞—É–Ω—Ç–∞'); 
                }
                
                function logout() { 
                    if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏?')) { 
                        alert('–í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã...'); 
                    } 
                }

                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
                document.addEventListener('DOMContentLoaded', function() {
                    populateDateSelect();
                    loadReportsForSelectedDate();
                    renderChart();
                });
            </script>
        </body>
        </html>